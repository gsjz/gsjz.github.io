# 边缘检测

## Canny 边缘检测

todo: 手搓 Canny 边缘检测

### Gaussian Smoothing

图像先和 Gauss 核卷积，抑制高频噪声，避免噪声被误判为边缘

$$
G(x,y) = \frac{1}{2\pi\sigma^2}\exp(-\frac{x^2 + y^2}{2\sigma^2})
$$

由于核归一化可以放到后面做（也应该后面做，因为所取的点是离散的若干个点，加起来的贡献肯定没全部积分起来大），所以实现的时候先忽略前面的系数。

???- tip "二维 Gauss 分布可视化"

    ```python
    def gaussian(x, y, sigma = 1.0):
        return np.exp(-(x**2 + y**2) / (2 * sigma**2)) / (2 * np.pi * sigma**2 )

    x = np.linspace(-3, 3, 100)
    y = np.linspace(-3, 3, 100)
    X, Y = np.meshgrid(x, y)
    Z = gaussian(X, Y, sigma = 1.4)

    fig = plt.figure(figsize = (10,7))
    ax = fig.add_subplot(111, projection="3d")
    suf = ax.plot_surface(X, Y, Z, cmap="viridis", edgecolor="none")

    ax.set_title('2D Gaussian Kernel Surface')
    ax.set_xlabel('X')
    ax.set_ylabel('Y')
    ax.set_zlabel('Z')
    fig.colorbar(suf, shrink = 0.5, aspect = 10)

    plt.show()

    res, err = integrate.dblquad(
        lambda y, x: gaussian(x, y, 1.4),
        -np.inf, np.inf,
        lambda x: -np.inf, 
        lambda x: np.inf
    )

    print(res)
    ```

    <img src="{{img_prefix}}20251219194729084.png"/ style="display:block; margin:0 auto; width:50%; ">

    ```text
    1.000000000000025
    ```


### 梯度计算

对平滑后的图像计算一阶导数，常用 Sobel 算子

$$
G_x = I * S_x,\quad G_y = I*S_y
$$


梯度幅值与方向：

$$
|G| = \sqrt{G_x^2 + G_y^2},\quad \theta = \arctan(\frac{G_y}{G_x})
$$


梯度幅值表达了边缘强度，梯度方向表达了边缘法线的方向。

### 非极大值抑制

之保留局部最大梯度值，将粗边压缩成为单像素宽。

做法：

- 沿着梯度方向
- 比较当前像素和前后两个像素
- 若不是最大值，则置 0




### 双阈值检测

设定两个阈值

- 高阈值 $T_{H}$：强边缘
- 低阈值 $T_{L}$：弱边缘

分类规则：

- $|G| \ge T_H$：强边缘（保留）
- $T_L \le |G| < T_H$：弱边缘（候选）
- $|G| < T_L$：抑制


### 边缘链接

弱边缘只有在链接到强边缘是才是真边缘：与强边缘 8 领域联通则保留，反之丢弃。






## Sobel 边缘检测

todo

## Laplacian 边缘检测

todo
