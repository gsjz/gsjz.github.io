# 251013

??? info "五段基本流水线"

    | 阶段名（中文）   | 英文缩写                                        | 主要工作                     | 发生时间  |
    | --------- | ------------------------------------------- | ------------------------ | ----- |
    | 取指令       | **IF** (Instruction Fetch)                  | 从内存中取出下一条指令              | 周期 t1 |
    | 指令译码/寄存器读 | **ID** (Instruction Decode / Register Read) | 解析指令，读取寄存器的操作数           | t2    |
    | 执行 / 地址计算 | **EX** (Execute)                            | 进行运算（比如加法）、计算内存地址        | t3    |
    | 访存        | **MEM** (Memory Access)                     | 如果需要访问内存（比如 lw/sw），就在这一步 | t4    |
    | 写回寄存器     | **WB** (Write Back)                         | 把运算结果写回寄存器（如 R1）         | t5    |


???+ question

    在无转发机制的五段基本流水线中，下列指令序列存在数据冒险的指令对是（ ）。

    I1: add R1, R2, R3; (R2)+(R3)→R1

    I2: add R5, R2, R4; (R2)+(R4)→R5

    I3: add R4, R5, R3; (R5)+(R3)→R4

    I4: add R5, R2, R6; (R2)+(R6)→R5

    A. I1 和 I2

    B. I2 和 I3

    C. I2 和 I4

    D. I3 和 I4

??? success
    
    B

    首先指令编号越大，执行得相对越晚。

    其次流水线实际上形如

    | 周期 | I1  | I2  | I3  | I4  |
    | -- | --- | --- | --- | --- |
    | 1  | IF  |     |     |     |
    | 2  | ID  | IF  |     |     |
    | 3  | EX  | ID  | IF  |     |
    | 4  | MEM | EX  | ID  | IF  |
    | 5  | WB  | MEM | EX  | ID  |
    | 6  |     | WB  | MEM | EX  |
    | 7  |     |     | WB  | MEM |
    | 8  |     |     |     | WB  |

    就是像字面上的流水线，五个工人轮流做。

    数据冒险即，同一个周期内，一个工人正准备修改当前这个数据，另一个工人又想拿来用。即同时出现 MEM 和 WB。

    即 $I_{i-1}$ 在写，$I_{i}$ 在读。






